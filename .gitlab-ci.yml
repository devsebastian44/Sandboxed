stages:
  - lint
  - security
  - verify

variables:
  PYTHON_VERSION: "3.9"

lint_python:
  stage: lint
  image: python:$PYTHON_VERSION
  script:
    - pip install flake8
    - flake8 src/sandbox.py

lint_shell:
  stage: lint
  image: ubuntu:latest
  script:
    - apt-get update && apt-get install -y shellcheck
    - shellcheck scripts/setup.sh

security_scan:
  stage: security
  image: python:$PYTHON_VERSION
  script:
    - pip install bandit
    - bandit -r src/

syntax_check:
  stage: verify
  image: python:$PYTHON_VERSION
  script:
    - python -m py_compile src/sandbox.py
    - bash -n scripts/setup.sh
